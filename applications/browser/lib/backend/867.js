exports.id=867,exports.ids=[867],exports.modules={73875:(e,t,s)=>{e=s.nmd(e);try{process.dlopen(e,__dirname+s(16928).sep+s.p+"native/nsfw.node")}catch(e){throw new Error("node-loader:\n"+e)}},11303:(e,t,s)=>{e.exports=s(69232)},45447:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileChangeCollection=void 0;t.FileChangeCollection=class{constructor(){this.changes=new Map}push(e){const t=this.changes.get(e.uri)||[];this.normalize(t,e),this.changes.set(e.uri,t)}normalize(e,t){let s,i=t.type;do{const t=e.pop();s=t&&t.type,i=this.reduce(s,i)}while(!Array.isArray(i)&&void 0!==s&&s!==i);const r=t.uri;Array.isArray(i)?e.push(...i.map((e=>({uri:r,type:e})))):e.push({uri:r,type:i})}reduce(e,t){return void 0===e?t:1===e?2===t?[1,2]:1:2===t?2:0}values(){return Array.from(this.changes.values()).reduce(((e,t)=>e.concat(t)),[])}}},8867:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NsfwFileSystemWatcherService=t.NsfwWatcher=t.WatcherDisposal=t.NsfwFileSystemWatcherServerOptions=void 0;const i=s(11303),r=s(16928),n=s(79896),o=s(53034),a=s(33929),h=s(45447),c=s(44196);t.NsfwFileSystemWatcherServerOptions=Symbol("NsfwFileSystemWatcherServerOptions"),t.WatcherDisposal=Symbol("WatcherDisposal");class l{constructor(e,s,i,r,n,o=1e4){this.fsPath=s,this.watcherOptions=i,this.nsfwFileSystemWatchServerOptions=r,this.fileSystemWatcherClient=n,this.deferredDisposalTimeout=o,this.disposed=!1,this.debugId=l.debugIdSequence++,this.deferredDisposalDeferred=new c.Deferred,this.refsPerClient=new Map,this.nsfwEventProcessingQueue=Promise.resolve(),this.whenDisposed=this.deferredDisposalDeferred.promise.catch((()=>{})),this.refsPerClient.set(e,{value:1}),this.whenStarted=this.start().then((()=>!0),(e=>{if(e===t.WatcherDisposal)return!1;throw this._dispose(),this.fireError(),e})),this.debug("NEW",`initialClientId=${e}`)}addRef(e){let t=this.refsPerClient.get(e);void 0===t?this.refsPerClient.set(e,t={value:1}):t.value+=1;const s=this.getTotalReferences(),i=1===s;i&&this.onRefsRevive(),this.debug("REF++",`clientId=${e}, clientRefs=${t.value}, totalRefs=${s}. revived=${i}`)}removeRef(e){const t=this.refsPerClient.get(e);if(void 0===t)return void this.info("WARN REF--",`removed one too many reference: clientId=${e}`);t.value-=1,0===t.value&&this.refsPerClient.delete(e);const s=this.getTotalReferences(),i=0===s;i&&this.onRefsReachZero(),this.debug("REF--",`clientId=${e}, clientRefs=${t.value}, totalRefs=${s}, dead=${i}`)}getClientIds(){return Array.from(this.refsPerClient.keys())}getTotalReferences(){let e=0;for(const t of this.refsPerClient.values())e+=t.value;return e}isInUse(){return this.refsPerClient.size>0}assertNotDisposed(){if(this.disposed)throw t.WatcherDisposal}async start(){for(;await n.promises.stat(this.fsPath).then((()=>!1),(()=>!0));)await(0,c.timeout)(500),this.assertNotDisposed();this.assertNotDisposed();const e=await this.createNsfw();if(this.assertNotDisposed(),await e.start(),this.debug("STARTED",`disposed=${this.disposed}`),this.disposed)throw await this.stopNsfw(e),t.WatcherDisposal;this.nsfw=e}async stopNsfw(e){await e.stop().then((()=>"success=true"),(e=>e)).then((e=>this.debug("STOPPED",e)))}async createNsfw(){const e=await n.promises.realpath(this.fsPath);return i(e,(e=>this.handleNsfwEvents(e)),{...this.nsfwFileSystemWatchServerOptions.nsfwOptions,errorCallback:t=>{console.error(`NSFW service error on "${e}":`,t),this._dispose(),this.fireError(),this.nsfwFileSystemWatchServerOptions.nsfwOptions.errorCallback&&this.nsfwFileSystemWatchServerOptions.nsfwOptions.errorCallback(t)}})}handleNsfwEvents(e){this.isInUse()&&(this.nsfwEventProcessingQueue=this.nsfwEventProcessingQueue.then((async()=>{const t=new h.FileChangeCollection;await Promise.all(e.map((async e=>{if(3===e.action){const[s,i]=await Promise.all([this.resolveEventPath(e.directory,e.oldFile),this.resolveEventPath(e.newDirectory,e.newFile)]);this.pushFileChange(t,2,s),this.pushFileChange(t,1,i)}else{const s=await this.resolveEventPath(e.directory,e.file);0===e.action?this.pushFileChange(t,1,s):1===e.action?this.pushFileChange(t,2,s):2===e.action&&this.pushFileChange(t,0,s)}})));const s=t.values();s.length>0&&this.fileSystemWatcherClient.onDidFilesChanged({clients:this.getClientIds(),changes:s})}),console.error))}async resolveEventPath(e,t){return r.resolve(e,t)}pushFileChange(e,t,s){if(!this.isIgnored(s)){const i=a.FileUri.create(s).toString();e.push({type:t,uri:i})}}fireError(){this.fileSystemWatcherClient.onError({clients:this.getClientIds(),uri:this.fsPath})}onRefsReachZero(){this.deferredDisposalTimer=setTimeout((()=>this._dispose()),this.deferredDisposalTimeout)}onRefsRevive(){this.deferredDisposalTimer&&(clearTimeout(this.deferredDisposalTimer),this.deferredDisposalTimer=void 0)}isIgnored(e){return this.watcherOptions.ignored.length>0&&this.watcherOptions.ignored.some((t=>t.match(e)))}async _dispose(){this.disposed||(this.disposed=!0,this.deferredDisposalDeferred.reject(t.WatcherDisposal),this.nsfw&&(this.stopNsfw(this.nsfw),this.nsfw=void 0),this.debug("DISPOSED"))}info(e,...t){this.nsfwFileSystemWatchServerOptions.info(`${e} NsfwWatcher(${this.debugId} at "${this.fsPath}"):`,...t)}debug(e,...t){this.nsfwFileSystemWatchServerOptions.verbose&&this.info(e,...t)}}t.NsfwWatcher=l,l.debugIdSequence=0;t.NsfwFileSystemWatcherService=class{constructor(e){this.watcherId=0,this.watchers=new Map,this.watcherHandles=new Map,this.maybeClient={onDidFilesChanged:e=>{var t;return null===(t=this.client)||void 0===t?void 0:t.onDidFilesChanged(e)},onError:e=>{var t;return null===(t=this.client)||void 0===t?void 0:t.onError(e)}},this.options={nsfwOptions:{},verbose:!1,info:(e,...t)=>console.info(e,...t),error:(e,...t)=>console.error(e,...t),...e}}setClient(e){this.client=e}async watchFileChanges(e,t,s){const i=this.resolveWatchOptions(s),r=this.getWatcherKey(t,i);let n=this.watchers.get(r);if(void 0===n){const s=a.FileUri.fsPath(t);n=this.createWatcher(e,s,i),n.whenDisposed.then((()=>this.watchers.delete(r))),this.watchers.set(r,n)}else n.addRef(e);const o=this.watcherId++;return this.watcherHandles.set(o,{clientId:e,watcher:n}),n.whenDisposed.then((()=>this.watcherHandles.delete(o))),o}createWatcher(e,t,s){const i={ignored:s.ignored.map((e=>new o.Minimatch(e,{dot:!0})))};return new l(e,t,i,this.options,this.maybeClient)}async unwatchFileChanges(e){const t=this.watcherHandles.get(e);void 0===t?console.warn(`tried to de-allocate a disposed watcher: watcherId=${e}`):(this.watcherHandles.delete(e),t.watcher.removeRef(t.clientId))}getWatcherKey(e,t){return[e,t.ignored.slice(0).sort().join()].join()}resolveWatchOptions(e){return{ignored:[],...e}}debug(e,...t){this.options.verbose&&this.options.info(e,...t)}dispose(){}}},64595:e=>{const t="object"==typeof process&&process&&"win32"===process.platform;e.exports=t?{sep:"\\"}:{sep:"/"}},53034:(e,t,s)=>{const i=e.exports=(e,t,s={})=>(m(t),!(!s.nocomment&&"#"===t.charAt(0))&&new v(t,s).match(e));e.exports=i;const r=s(64595);i.sep=r.sep;const n=Symbol("globstar **");i.GLOBSTAR=n;const o=s(47364),a={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},h="[^/]",c=h+"*?",l=e=>e.split("").reduce(((e,t)=>(e[t]=!0,e)),{}),p=l("().*{}+?[]^$\\!"),d=l("[.("),u=/\/+/;i.filter=(e,t={})=>(s,r,n)=>i(s,e,t);const f=(e,t={})=>{const s={};return Object.keys(e).forEach((t=>s[t]=e[t])),Object.keys(t).forEach((e=>s[e]=t[e])),s};i.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return i;const t=i,s=(s,i,r)=>t(s,i,f(e,r));return(s.Minimatch=class extends t.Minimatch{constructor(t,s){super(t,f(e,s))}}).defaults=s=>t.defaults(f(e,s)).Minimatch,s.filter=(s,i)=>t.filter(s,f(e,i)),s.defaults=s=>t.defaults(f(e,s)),s.makeRe=(s,i)=>t.makeRe(s,f(e,i)),s.braceExpand=(s,i)=>t.braceExpand(s,f(e,i)),s.match=(s,i,r)=>t.match(s,i,f(e,r)),s},i.braceExpand=(e,t)=>g(e,t);const g=(e,t={})=>(m(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:o(e)),m=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")},w=Symbol("subparse");i.makeRe=(e,t)=>new v(e,t||{}).makeRe(),i.match=(e,t,s={})=>{const i=new v(t,s);return e=e.filter((e=>i.match(e))),i.options.nonull&&!e.length&&e.push(t),e};const b=e=>e.replace(/[[\]\\]/g,"\\$&");class v{constructor(e,t){m(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();let s=this.globSet=this.braceExpand();t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,s),s=this.globParts=s.map((e=>e.split(u))),this.debug(this.pattern,s),s=s.map(((e,t,s)=>e.map(this.parse,this))),this.debug(this.pattern,s),s=s.filter((e=>-1===e.indexOf(!1))),this.debug(this.pattern,s),this.set=s}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let t=!1,s=0;for(let i=0;i<e.length&&"!"===e.charAt(i);i++)t=!t,s++;s&&(this.pattern=e.slice(s)),this.negate=t}matchOne(e,t,s){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var r=0,o=0,a=e.length,h=t.length;r<a&&o<h;r++,o++){this.debug("matchOne loop");var c,l=t[o],p=e[r];if(this.debug(t,l,p),!1===l)return!1;if(l===n){this.debug("GLOBSTAR",[t,l,p]);var d=r,u=o+1;if(u===h){for(this.debug("** at the end");r<a;r++)if("."===e[r]||".."===e[r]||!i.dot&&"."===e[r].charAt(0))return!1;return!0}for(;d<a;){var f=e[d];if(this.debug("\nglobstar while",e,d,t,u,f),this.matchOne(e.slice(d),t.slice(u),s))return this.debug("globstar found match!",d,a,f),!0;if("."===f||".."===f||!i.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,d,t,u);break}this.debug("globstar swallow a segment, and continue"),d++}return!(!s||(this.debug("\n>>> no match, partial?",e,d,t,u),d!==a))}if("string"==typeof l?(c=p===l,this.debug("string match",l,p,c)):(c=p.match(l),this.debug("pattern match",l,p,c)),!c)return!1}if(r===a&&o===h)return!0;if(r===a)return s;if(o===h)return r===a-1&&""===e[r];throw new Error("wtf?")}braceExpand(){return g(this.pattern,this.options)}parse(e,t){m(e);const s=this.options;if("**"===e){if(!s.noglobstar)return n;e="*"}if(""===e)return"";let i="",r=!1,o=!1;const l=[],u=[];let f,g,v,y,E=!1,C=-1,S=-1,D="."===e.charAt(0),x=s.dot||D;const O=e=>"."===e.charAt(0)?"":s.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",P=()=>{if(f){switch(f){case"*":i+=c,r=!0;break;case"?":i+=h,r=!0;break;default:i+="\\"+f}this.debug("clearStateChar %j %j",f,i),f=!1}};for(let t,n=0;n<e.length&&(t=e.charAt(n));n++)if(this.debug("%s\t%s %s %j",e,n,i,t),o){if("/"===t)return!1;p[t]&&(i+="\\"),i+=t,o=!1}else switch(t){case"/":return!1;case"\\":if(E&&"-"===e.charAt(n+1)){i+=t;continue}P(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,n,i,t),E){this.debug("  in class"),"!"===t&&n===S+1&&(t="^"),i+=t;continue}this.debug("call clearStateChar %j",f),P(),f=t,s.noext&&P();continue;case"(":{if(E){i+="(";continue}if(!f){i+="\\(";continue}const t={type:f,start:n-1,reStart:i.length,open:a[f].open,close:a[f].close};this.debug(this.pattern,"\t",t),l.push(t),i+=t.open,0===t.start&&"!"!==t.type&&(D=!0,i+=O(e.slice(n+1))),this.debug("plType %j %j",f,i),f=!1;continue}case")":{const e=l[l.length-1];if(E||!e){i+="\\)";continue}l.pop(),P(),r=!0,v=e,i+=v.close,"!"===v.type&&u.push(Object.assign(v,{reEnd:i.length}));continue}case"|":{const t=l[l.length-1];if(E||!t){i+="\\|";continue}P(),i+="|",0===t.start&&"!"!==t.type&&(D=!0,i+=O(e.slice(n+1)));continue}case"[":if(P(),E){i+="\\"+t;continue}E=!0,S=n,C=i.length,i+=t;continue;case"]":if(n===S+1||!E){i+="\\"+t;continue}g=e.substring(S+1,n);try{RegExp("["+b(g.replace(/\\([^-\]])/g,"$1"))+"]"),i+=t}catch(e){i=i.substring(0,C)+"(?:$.)"}r=!0,E=!1;continue;default:P(),!p[t]||"^"===t&&E||(i+="\\"),i+=t}for(E&&(g=e.slice(S+1),y=this.parse(g,w),i=i.substring(0,C)+"\\["+y[0],r=r||y[1]),v=l.pop();v;v=l.pop()){let e;e=i.slice(v.reStart+v.open.length),this.debug("setting tail",i,v),e=e.replace(/((?:\\{2}){0,64})(\\?)\|/g,((e,t,s)=>(s||(s="\\"),t+t+s+"|"))),this.debug("tail=%j\n   %s",e,e,v,i);const t="*"===v.type?c:"?"===v.type?h:"\\"+v.type;r=!0,i=i.slice(0,v.reStart)+t+"\\("+e}P(),o&&(i+="\\\\");const R=d[i.charAt(0)];for(let e=u.length-1;e>-1;e--){const s=u[e],r=i.slice(0,s.reStart),n=i.slice(s.reStart,s.reEnd-8);let o=i.slice(s.reEnd);const a=i.slice(s.reEnd-8,s.reEnd)+o,h=r.split(")").length,c=r.split("(").length-h;let l=o;for(let e=0;e<c;e++)l=l.replace(/\)[+*?]?/,"");o=l;i=r+n+o+(""===o&&t!==w?"(?:$|\\/)":"")+a}if(""!==i&&r&&(i="(?=.)"+i),R&&(i=(D?"":x?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)")+i),t===w)return[i,r];if(s.nocase&&!r&&(r=e.toUpperCase()!==e.toLowerCase()),!r)return(e=>e.replace(/\\(.)/g,"$1"))(e);const F=s.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",F),{_glob:e,_src:i})}catch(e){return new RegExp("$.")}}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,s=t.noglobstar?c:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",i=t.nocase?"i":"";let r=e.map((e=>(e=e.map((e=>"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===n?n:e._src)).reduce(((e,t)=>(e[e.length-1]===n&&t===n||e.push(t),e)),[]),e.forEach(((t,i)=>{t===n&&e[i-1]!==n&&(0===i?e.length>1?e[i+1]="(?:\\/|"+s+"\\/)?"+e[i+1]:e[i]=s:i===e.length-1?e[i-1]+="(?:\\/|"+s+")?":(e[i-1]+="(?:\\/|\\/"+s+"\\/)"+e[i+1],e[i+1]=n))})),e.filter((e=>e!==n)).join("/")))).join("|");r="^(?:"+r+")$",this.negate&&(r="^(?!"+r+").*$");try{this.regexp=new RegExp(r,i)}catch(e){this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;const s=this.options;"/"!==r.sep&&(e=e.split(r.sep).join("/")),e=e.split(u),this.debug(this.pattern,"split",e);const i=this.set;let n;this.debug(this.pattern,"set",i);for(let t=e.length-1;t>=0&&(n=e[t],!n);t--);for(let r=0;r<i.length;r++){const o=i[r];let a=e;s.matchBase&&1===o.length&&(a=[n]);if(this.matchOne(a,o,t))return!!s.flipNegate||!this.negate}return!s.flipNegate&&this.negate}static defaults(e){return i.defaults(e).Minimatch}}i.Minimatch=v},70877:e=>{"use strict";function t(e,t,r){e instanceof RegExp&&(e=s(e,r)),t instanceof RegExp&&(t=s(t,r));var n=i(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function s(e,t){var s=t.match(e);return s?s[0]:null}function i(e,t,s){var i,r,n,o,a,h=s.indexOf(e),c=s.indexOf(t,h+1),l=h;if(h>=0&&c>0){if(e===t)return[h,c];for(i=[],n=s.length;l>=0&&!a;)l==h?(i.push(l),h=s.indexOf(e,l+1)):1==i.length?a=[i.pop(),c]:((r=i.pop())<n&&(n=r,o=c),c=s.indexOf(t,l+1)),l=h<c&&h>=0?h:c;i.length&&(a=[n,o])}return a}e.exports=t,t.range=i},47364:(e,t,s)=>{var i=s(70877);e.exports=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return m(function(e){return e.split("\\\\").join(r).split("\\{").join(n).split("\\}").join(o).split("\\,").join(a).split("\\.").join(h)}(e),!0).map(l)};var r="\0SLASH"+Math.random()+"\0",n="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",a="\0COMMA"+Math.random()+"\0",h="\0PERIOD"+Math.random()+"\0";function c(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function l(e){return e.split(r).join("\\").split(n).join("{").split(o).join("}").split(a).join(",").split(h).join(".")}function p(e){if(!e)return[""];var t=[],s=i("{","}",e);if(!s)return e.split(",");var r=s.pre,n=s.body,o=s.post,a=r.split(",");a[a.length-1]+="{"+n+"}";var h=p(o);return o.length&&(a[a.length-1]+=h.shift(),a.push.apply(a,h)),t.push.apply(t,a),t}function d(e){return"{"+e+"}"}function u(e){return/^-?0\d/.test(e)}function f(e,t){return e<=t}function g(e,t){return e>=t}function m(e,t){var s=[],r=i("{","}",e);if(!r)return[e];var n=r.pre,a=r.post.length?m(r.post,!1):[""];if(/\$$/.test(r.pre))for(var h=0;h<a.length;h++){var l=n+"{"+r.body+"}"+a[h];s.push(l)}else{var w,b,v=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),y=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),E=v||y,C=r.body.indexOf(",")>=0;if(!E&&!C)return r.post.match(/,.*\}/)?m(e=r.pre+"{"+r.body+o+r.post):[e];if(E)w=r.body.split(/\.\./);else if(1===(w=p(r.body)).length&&1===(w=m(w[0],!1).map(d)).length)return a.map((function(e){return r.pre+w[0]+e}));if(E){var S=c(w[0]),D=c(w[1]),x=Math.max(w[0].length,w[1].length),O=3==w.length?Math.abs(c(w[2])):1,P=f;D<S&&(O*=-1,P=g);var R=w.some(u);b=[];for(var F=S;P(F,D);F+=O){var W;if(y)"\\"===(W=String.fromCharCode(F))&&(W="");else if(W=String(F),R){var $=x-W.length;if($>0){var j=new Array($+1).join("0");W=F<0?"-"+j+W.slice(1):j+W}}b.push(W)}}else{b=[];for(var I=0;I<w.length;I++)b.push.apply(b,m(w[I],!1))}for(I=0;I<b.length;I++)for(h=0;h<a.length;h++){l=n+b[I]+a[h];(!t||E||l)&&s.push(l)}}return s}},69232:(e,t,s)=>{const{promises:i}=s(79896),r=s(16928),n=s(73875);function o(e,t,s){const{CREATED:n,DELETED:o,MODIFIED:a}=h.actions,c=r.dirname(e),l=r.basename(e);let p,d;const u=async()=>{try{const s=await i.stat(e);null===p?(p=s,t([{action:n,directory:c,file:l}])):s.mtime-p.mtime==0&&s.ctime-p.ctime==0||(p=s,t([{action:a,directory:c,file:l}]))}catch(e){null!==p&&(p=null,t([{action:o,directory:c,file:l}]))}};this.start=async()=>{try{p=await i.stat(e)}catch(e){p=null}d=setInterval(u,s)},this.stop=async()=>{clearInterval(d)},this.pause=()=>this.stop(),this.resume=()=>this.start()}const a=async(e,t,{debounceMS:s=500,errorCallback:a,excludedPaths:h=[]}={})=>{if(!Number.isInteger(s))throw new Error("debounceMS must be an integer.");if(s<1)throw new Error("Minimum debounce is 1ms.");const c=a||(e=>{throw e});if(!r.isAbsolute(e))throw new Error("Path to watch must be an absolute path.");let l;try{l=await i.stat(e)}catch(e){throw new Error("Path must be a valid path to a file or a directory.")}if(h)for(let t=0;t<h.length;t++){const s=h[t];if("win32"===process.platform){if(!s.substring(0,e.length-1).localeCompare(e,void 0,{sensitivity:"accent"}))throw new Error("Excluded path must be a valid subdirectory of the watching path.")}else if(!s.startsWith(e))throw new Error("Excluded path must be a valid subdirectory of the watching path.")}if(l.isDirectory())return new n(e,t,{debounceMS:s,errorCallback:c,excludedPaths:h});if(l.isFile())return new o(e,t,s);throw new Error("Path must be a valid path to a file or a directory")};function h(e,t,s){if(!(this instanceof h))return a(e,t,s).then((e=>new h(e)));const i=e;this.start=()=>i.start(),this.stop=()=>i.stop(),this.pause=()=>i.pause(),this.resume=()=>i.resume(),this.getExcludedPaths=()=>i.getExcludedPaths(),this.updateExcludedPaths=e=>i.updateExcludedPaths(e)}h.actions={CREATED:0,DELETED:1,MODIFIED:2,RENAMED:3},h._native=n,n.getAllocatedInstanceCount&&(h.getAllocatedInstanceCount=n.getAllocatedInstanceCount),e.exports=h}};